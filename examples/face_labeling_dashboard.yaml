# WhoRang Face Labeling Dashboard Example
# Add this to your Home Assistant dashboard to manage face labeling

title: WhoRang Face Management
views:
  - title: Face Labeling
    icon: mdi:face-recognition
    cards:
      # Face Detection Status Overview
      - type: entities
        title: Face Detection Status
        entities:
          - entity: sensor.whorang_unknown_faces
            name: Unknown Faces Requiring Labeling
            icon: mdi:face-recognition
          - entity: sensor.whorang_latest_face_detection
            name: Latest Face Detection
            icon: mdi:face-man
          - entity: sensor.whorang_known_faces
            name: Known Faces Count
            icon: mdi:account-group

      # Unknown Faces Alert
      - type: conditional
        conditions:
          - entity: sensor.whorang_unknown_faces
            state_not: "0"
        card:
          type: markdown
          content: |
            ## ⚠️ Unknown Faces Detected
            
            You have **{{ states('sensor.whorang_unknown_faces') }}** unknown face(s) that need labeling.
            
            **Latest Detection:** {{ states('sensor.whorang_latest_face_detection') }}
            
            Use the services below to label faces and improve recognition accuracy.

      # Face Management Actions
      - type: entities
        title: Face Management Actions
        entities:
          - type: button
            name: "Refresh Unknown Faces"
            icon: mdi:refresh
            action_name: "refresh_unknown"
            tap_action:
              action: call-service
              service: whorang.get_unknown_faces
              service_data:
                limit: 50
                quality_threshold: 0.6

          - type: button
            name: "Get Face Similarities"
            icon: mdi:face-recognition
            action_name: "get_similarities"
            tap_action:
              action: call-service
              service: whorang.get_face_similarities
              service_data:
                face_id: 1  # Replace with actual face ID
                threshold: 0.6
                limit: 10

      # Manual Face Labeling Form
      - type: entities
        title: Label Unknown Face
        entities:
          - type: input_number
            name: "Face ID"
            entity: input_number.face_id_input
            
          - type: input_text
            name: "Person Name"
            entity: input_text.person_name_input
            
          - type: button
            name: "Label Face"
            icon: mdi:tag
            tap_action:
              action: call-service
              service: whorang.label_face
              service_data:
                face_id: "{{ states('input_number.face_id_input') | int }}"
                person_name: "{{ states('input_text.person_name_input') }}"

          - type: button
            name: "Create New Person"
            icon: mdi:account-plus
            tap_action:
              action: call-service
              service: whorang.create_person_from_face
              service_data:
                face_id: "{{ states('input_number.face_id_input') | int }}"
                person_name: "{{ states('input_text.person_name_input') }}"
                description: "Added via dashboard"

      # Face Statistics
      - type: entities
        title: Face Recognition Statistics
        entities:
          - entity: sensor.whorang_known_faces
            name: Total Known Faces
            secondary_info: last-updated
          - entity: sensor.whorang_unknown_faces
            name: Unknown Faces
            secondary_info: last-updated
          - entity: sensor.whorang_latest_face_detection
            name: Latest Detection
            secondary_info: last-updated

      # System Status
      - type: entities
        title: System Status
        entities:
          - entity: sensor.whorang_system_status
            name: WhoRang System
          - entity: sensor.whorang_ai_provider_active
            name: AI Provider
          - entity: sensor.whorang_ai_response_time
            name: AI Response Time

# Required Helper Entities
# Add these to your configuration.yaml:

# input_number:
#   face_id_input:
#     name: Face ID for Labeling
#     min: 1
#     max: 10000
#     step: 1
#     mode: box
#     icon: mdi:identifier

# input_text:
#   person_name_input:
#     name: Person Name for Labeling
#     max: 100
#     icon: mdi:account
